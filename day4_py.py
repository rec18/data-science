# -*- coding: utf-8 -*-
"""day4.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Wl0xb2wgeB-DMVZx_xwRvqbm-Boi0LQ9
"""

import qrcode
img = qrcode.make('https://colab.research.google.com/drive/1IAw00TMqgNmWZ1QKPTn_S23yKGiHYIEI?usp=sharing')
img.save('myqr.png')

# pip install qrcode

import pymysql as py
print('Done')

pip install PyMySQL

conn = py.connect(user = 'root',
           password='1234',
           host='localhost',
           autocommit = True)

print('Connection Created Successfully!!')
print('Done')

query = '''create database IITM_day5;'''

query = '''insert into student_details
values
(101,"Mohan Sharma","BCA","Delhi Janakpuri",5000),
(105,"Ravi verma","MCA","South Delhi",5500);
'''

select * from iitm_day5.student_details;

sid = int(input('Enter Roll No/SID: '))
name = input('Enter your Name: ')
course = input('Enter your Course: ')
address = input('Enter your Address: ')
scholarship = float(input('Enter your scholarship in RS: '))

sid = int(input('Enter Roll No/SID: '))
name = input('Enter your Name: ')
course = input('Enter your Course: ')
address = input('Enter your Address: ')
scholarship = float(input('Enter your scholarship in RS: '))

q = f'''insert into student_details values
({sid},"{name}","{course}","{address}",{scholarship});'''

cur.execute(q)
print('Done')

n = 3
for i in range(n):
    sid = int(input('Enter Roll No/SID: '))
    name = input('Enter your Name: ')
    course = input('Enter your Course: ')
    address = input('Enter your Address: ')
    scholarship = float(input('Enter your scholarship in RS: '))

    q = f'''insert into student_details values
    ({sid},"{name}","{course}","{address}",{scholarship});'''

    cur.execute(q)
    print('Record Inserted Successfully!!')
print('Done')

query = '''select * from student_details;'''
cur.execute(query)

records = cur.fetchall()

all_columns = []
for i in cur.description:
    all_columns.append(i[0])


import pandas as pd
pd.DataFrame(records,columns=all_columns)

def show_records(db,table):
    query = f'''select * from {db}.{table};'''
    cur.execute(query)

    records = cur.fetchall()

    all_columns = []
    for i in cur.description:
        all_columns.append(i[0])


    import pandas as pd
    df = pd.DataFrame(records,columns=all_columns)
    return df